<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>V√≤ng Quay L√¨ X√¨ May M·∫Øn</title>

<style>
body{
  font-family: Arial, sans-serif;
  text-align:center;
  background:linear-gradient(#fff5d6,#ffe4a8);
  margin:0;
  padding:0;
  min-height:100vh;
}

h1{
  margin-top:25px;
  font-size:28px;
  color:darkred;
}

canvas{
  margin-top:20px;
  width:90vw;
  max-width:500px;
  height:auto;
}

button{
  margin-top:20px;
  padding:14px 35px;
  font-size:18px;
  background:darkred;
  color:white;
  border:none;
  border-radius:15px;
  cursor:pointer;
}

.modal{
  display:none;
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.55);
  justify-content:center;
  align-items:center;
  z-index:999;
}

.modal-content{
  background:white;
  width:650px;
  max-width:90%;
  border-radius:25px;
  padding:30px;
  box-shadow:0 0 25px rgba(0,0,0,0.4);
}

.lixiBox{
  position:relative;
  display:inline-block;
}

#lixiImage{
  width:320px;
  max-width:80vw;
  cursor:pointer;
  transition:transform 0.4s ease;
}

#rewardText{
  position:absolute;
  top:120px;
  left:50%;
  transform:translateX(-50%);
  font-size:24px;
  font-weight:bold;
  color:darkred;
  display:none;
}

#rewardText.show{
  display:block;
}

#closeBtn{
  margin-top:20px;
  padding:12px 30px;
  font-size:18px;
  border-radius:15px;
  background:darkred;
  color:white;
  cursor:pointer;
}
</style>
</head>

<body>

<h1>üé° V√≤ng Quay L√¨ X√¨ May M·∫Øn üéÅ</h1>

<canvas id="wheel"></canvas>
<br>
<button id="spinBtn">üé≤ QUAY NGAY</button>

<div class="modal" id="modal">
  <div class="modal-content">
    <h2>üßß M·ªû L√å X√å NH·∫¨N QU√Ä</h2>

    <div class="lixiBox">
      <img id="lixiImage" src="images/lixi.png">
      <div id="rewardText"></div>
    </div>

    <br>
    <button id="closeBtn">ƒê√≥ng</button>
  </div>
</div>

<script>
const canvas=document.getElementById("wheel");
const ctx=canvas.getContext("2d");

function resizeCanvas(){
  let size=Math.min(window.innerWidth*0.9,500);
  canvas.width=size;
  canvas.height=size;
}
resizeCanvas();
window.addEventListener("resize",()=>{
  resizeCanvas();
  drawWheel();
});

const spinBtn=document.getElementById("spinBtn");
const modal=document.getElementById("modal");
const closeBtn=document.getElementById("closeBtn");
const lixiImage=document.getElementById("lixiImage");
const rewardText=document.getElementById("rewardText");

const prizes=[
 {name:"10K",weight:0},
 {name:"50K",weight:0},
 {name:"100K",weight:0},
 {name:"200K",weight:0},
 {name:"500K",weight:0},
 {name:"‚ù§Ô∏è nh·ªè b√© c·ªßa Ph√∫c",weight:100},
 {name:"1 Tri·ªáu",weight:0}
];

const sliceAngle=(2*Math.PI)/prizes.length;
let angle=0;
let spinning=false;
let finalReward="";

const lixiIcon=new Image();
lixiIcon.src="images/lixi.png";

function drawWheel(){
 let center=canvas.width/2;
 let wheelRadius=canvas.width*0.45;
 let iconRadius=canvas.width*0.32;
 let iconSize=canvas.width*0.12;

 ctx.clearRect(0,0,canvas.width,canvas.height);

 for(let i=0;i<prizes.length;i++){
   let start=angle+i*sliceAngle;

   ctx.beginPath();
   ctx.moveTo(center,center);
   ctx.arc(center,center,wheelRadius,start,start+sliceAngle);
   ctx.fillStyle=i%2===0?"#FFD84D":"#F4B400";
   ctx.fill();
   ctx.stroke();

   let mid=start+sliceAngle/2;

   let x=center+iconRadius*Math.cos(mid);
   let y=center+iconRadius*Math.sin(mid);

   ctx.save();
   ctx.translate(x,y);
   ctx.rotate(mid+Math.PI/2);
   ctx.drawImage(lixiIcon,-iconSize/2,-iconSize,iconSize,iconSize*1.3);
   ctx.restore();

   ctx.save();
   ctx.translate(center,center);
   ctx.rotate(mid);
   ctx.textAlign="right";
   ctx.fillStyle="darkred";
   ctx.font=(canvas.width*0.05)+"px Arial";
   ctx.restore();
 }

 ctx.fillStyle="darkred";
 ctx.beginPath();
 ctx.moveTo(center-15,10);
 ctx.lineTo(center+15,10);
 ctx.lineTo(center,60);
 ctx.fill();
}

function getPrize(){
 let total=prizes.reduce((s,p)=>s+p.weight,0);
 let rand=Math.random()*total;
 for(let p of prizes){
   if(rand<p.weight) return p.name;
   rand-=p.weight;
 }
}

function showResult(prize){
 finalReward=prize;
 lixiImage.src="images/lixi.png";
 rewardText.innerHTML="";
 rewardText.classList.remove("show");
 modal.style.display="flex";
}

lixiImage.onclick=function(){
 lixiImage.src="images/lixi_open.png";
 rewardText.innerHTML=finalReward;
 rewardText.classList.add("show");
};

spinBtn.onclick=function(){
 if(spinning) return;
 spinning=true;
 let prize=getPrize();
 let time=0;

 let spin=setInterval(()=>{
   angle+=0.25;
   drawWheel();
   time+=50;

   if(time>3000){
     clearInterval(spin);
     spinning=false;
     showResult(prize);
   }
 },50);
};

closeBtn.onclick=function(){
 modal.style.display="none";
};

lixiIcon.onload=function(){
 drawWheel();
};
</script>

</body>
</html>
