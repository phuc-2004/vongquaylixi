<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>V√≤ng quay l√¨ x√¨</title>
<style>
body{
    text-align:center;
    background:#f5e6c8;
}
#wheel{
    margin-top:20px;
}
button{
    padding:10px 20px;
    font-size:18px;
    margin-top:20px;
}
</style>
</head>

<body>

<h2>V√≤ng quay l√¨ x√¨</h2>

<canvas id="wheel" width="500" height="500"></canvas>
<br>
<button onclick="spin()">Quay</button>

<script>
const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");

const slices = 8;
const sliceAngle = 2 * Math.PI / slices;
const center = canvas.width / 2;

let rotation = 0;
let spinning = false;

const colors = ["#f2c94c","#e0b400"];

const lixiIcon = new Image();
lixiIcon.src = "https://i.imgur.com/6X4V6XK.png"; // h√¨nh l√¨ x√¨ c·ªßa b·∫°n

lixiIcon.onload = function(){
    drawWheel();
};

function drawWheel(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    for(let i=0;i<slices;i++){
        let angle = i * sliceAngle + rotation;

        ctx.beginPath();
        ctx.moveTo(center,center);
        ctx.arc(center,center,center-5,angle,angle+sliceAngle);
        ctx.closePath();
        ctx.fillStyle = colors[i%2];
        ctx.fill();
        ctx.stroke();

        // ====== ICON ======
        let mid = angle + sliceAngle/2;

        // üî• CH·ªà S·ª¨A ·ªû ƒê√ÇY (0.27 thay v√¨ 0.32)
        let iconRadius = canvas.width * 0.27;

        let iconSize = 60;

        let x = center + iconRadius * Math.cos(mid);
        let y = center + iconRadius * Math.sin(mid);

        ctx.save();
        ctx.translate(x,y);
        ctx.rotate(mid);
        ctx.drawImage(lixiIcon,-iconSize/2,-iconSize/2,iconSize,iconSize);
        ctx.restore();
    }

    // m≈©i t√™n
    ctx.fillStyle = "red";
    ctx.beginPath();
    ctx.moveTo(center-15,10);
    ctx.lineTo(center+15,10);
    ctx.lineTo(center,50);
    ctx.fill();
}

function spin(){
    if(spinning) return;
    spinning = true;

    let spinTime = 3000;
    let start = null;
    let extra = Math.random()*360;

    function animate(timestamp){
        if(!start) start = timestamp;
        let progress = timestamp - start;

        rotation += 0.3;

        drawWheel();

        if(progress < spinTime){
            requestAnimationFrame(animate);
        } else {
            spinning = false;
        }
    }

    requestAnimationFrame(animate);
}
</script>

</body>
</html>
